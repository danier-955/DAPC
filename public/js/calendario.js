$(document).ready(function(){$("#calendar").fullCalendar({theme:"bootstrap4",locale:"es",header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay,listMonth"},buttonText:{today:"Hoy",month:"Mes",week:"Semana",day:"Agenda",list:"Día"},allDayHtml:"Todo<br/>el día",eventLimitText:"más",noEventsMessage:"No hay eventos para mostrar",buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow"},defaultDate:moment().format("YYYY-MM-DD"),timezone:"America/Bogota",navLinks:!0,editable:!0,eventLimit:!0,events:{url:"/calendarios/eventos",type:"GET",error:function(e){swal({title:e.responseJSON.message,type:"error",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})},color:"#ff9800"},loading:function(e,a){$(".cargando").toggle()},dayClick:function(e,a,i){e.format("YYYY-MM-DD")<moment().format("YYYY-MM-DD")?swal({title:"¡No es válido registrar un calendario desde una fecha pasada!",type:"error",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"}):($("[name='fech_inic']").val(e.format()),$('[class^="end-datepicker"]').bootstrapMaterialDatePicker("setMinDate",e),$("#createCalendario").modal("show"))},eventClick:function(e,a,i){var t=void 0,n=void 0;e.end?(t=e.end.format("YYYY-MM-DD"),n=e.end.format("hh:mm a")):(t=e.start.format("YYYY-MM-DD"),n=e.start.format("hh:mm a")),$("[name='id']").val(e.idCalendario),$("[name='edit_titu_cale']").val(e.title),$("[name='edit_fech_inic']").val(e.start.format("YYYY-MM-DD")),$("[name='edit_hora_inic']").val(e.start.format("hh:mm a")),$("[name='edit_fech_fina']").val(t),$("[name='edit_hora_fina']").val(n),$("[name='edit_desc_cale']").val(e.desc_cale),$("[name='edit_fina_cale']").val(e.fina_cale),$("[name='edit_administrativo_id']").val(e.administrativo_id),$("[name='edit_administrativo_id']").selectpicker("refresh"),$('[class^="end-datepicker"]').bootstrapMaterialDatePicker("setMinDate",e.start),$("#editCalendario").modal("show")}}),$("#storeCalendario").submit(function(e){e.preventDefault();for(var a=["titu_cale","fech_inic","hora_inic","fech_fina","hora_fina","administrativo_id","desc_cale","fina_cale"],i=0;i<a.length;i++)$('[name="'+a[i]+'"]').removeClass("is-invalid"),$("#error_"+a[i]).removeClass("invalid-feedback").empty();var t={titu_cale:$("[name='titu_cale']").val(),fech_inic:$("[name='fech_inic']").val()+" "+$("[name='hora_inic']").val(),fech_fina:$("[name='fech_fina']").val()+" "+$("[name='hora_fina']").val(),desc_cale:$("[name='desc_cale']").val(),fina_cale:$("[name='fina_cale']").val(),administrativo_id:$("[name='administrativo_id']").val()};$.ajax({url:"calendarios",type:"POST",headers:{"X-CSRF-TOKEN":$("[name='_token']").val()},data:t,dataType:"JSON",cache:!1,beforeSend:function(){$(".loading").show()},success:function(e){$("#storeCalendario").trigger("refresh"),$("[name='administrativo_id']").selectpicker("refresh"),$("#createCalendario").modal("hide"),$("#calendar").fullCalendar("refetchEvents"),swal({title:e.message,type:"success",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})},error:function(e){void 0!==e.responseJSON.errors?(void 0!==e.responseJSON.errors.titu_cale&&($('input[name="titu_cale"]').addClass("is-invalid"),$("#error_titu_cale").addClass("invalid-feedback").empty().html(e.responseJSON.errors.titu_cale[0])),void 0!==e.responseJSON.errors.fech_inic&&($('input[name="fech_inic"]').addClass("is-invalid"),$("#error_fech_inic").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_inic[0]),$('input[name="hora_inic"]').addClass("is-invalid"),$("#error_hora_inic").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_inic[0])),void 0!==e.responseJSON.errors.fech_fina&&($('input[name="fech_fina"]').addClass("is-invalid"),$("#error_fech_fina").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_fina[0]),$('input[name="hora_fina"]').addClass("is-invalid"),$("#error_hora_fina").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_fina[0])),void 0!==e.responseJSON.errors.desc_cale&&($('textarea[name="desc_cale"]').addClass("is-invalid"),$("#error_desc_cale").addClass("invalid-feedback").empty().html(e.responseJSON.errors.desc_cale[0])),void 0!==e.responseJSON.errors.fina_cale&&($('textarea[name="fina_cale"]').addClass("is-invalid"),$("#error_fina_cale").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fina_cale[0]))):swal({title:e.responseJSON.message,type:"error",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})},complete:function(){$(".loading").hide(),$("#storeCalendario").find('button[type="submit"]').attr("disabled",!1)}})}),$("#updateCalendario").submit(function(e){e.preventDefault(),e.stopPropagation();for(var a=["titu_cale","fech_inic","hora_inic","fech_fina","hora_fina","administrativo_id","desc_cale","fina_cale"],i=0;i<a.length;i++)$('[name="edit_'+a[i]+'"]').removeClass("is-invalid"),$("#error_edit_"+a[i]).removeClass("invalid-feedback").empty();var t=$("[name='id']").val().trim(),n={titu_cale:$("[name='edit_titu_cale']").val(),fech_inic:$("[name='edit_fech_inic']").val()+" "+$("[name='edit_hora_inic']").val(),fech_fina:$("[name='edit_fech_fina']").val()+" "+$("[name='edit_hora_fina']").val(),desc_cale:$("[name='edit_desc_cale']").val(),fina_cale:$("[name='edit_fina_cale']").val(),administrativo_id:$("[name='edit_administrativo_id']").val()};$.ajax({url:"/calendarios/"+t,type:"PUT",headers:{"X-CSRF-TOKEN":$("[name='_token']").val()},data:n,dataType:"JSON",cache:!1,beforeSend:function(){$(".loading").show()},success:function(e){$("#editCalendario").modal("hide"),$("#calendar").fullCalendar("refetchEvents"),swal({title:e.message,type:"success",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})},error:function(e){void 0!==e.responseJSON.errors?(void 0!==e.responseJSON.errors.titu_cale&&($('input[name="edit_titu_cale"]').addClass("is-invalid"),$("#error_edit_titu_cale").addClass("invalid-feedback").empty().html(e.responseJSON.errors.titu_cale[0])),void 0!==e.responseJSON.errors.fech_inic&&($('input[name="edit_fech_inic"]').addClass("is-invalid"),$("#error_edit_fech_inic").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_inic[0]),$('input[name="edit_hora_inic"]').addClass("is-invalid"),$("#error_edit_hora_inic").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_inic[0])),void 0!==e.responseJSON.errors.fech_fina&&($('input[name="edit_fech_fina"]').addClass("is-invalid"),$("#error_edit_fech_fina").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_fina[0]),$('input[name="edit_hora_fina"]').addClass("is-invalid"),$("#error_edit_hora_fina").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fech_fina[0])),void 0!==e.responseJSON.errors.desc_cale&&($('textarea[name="edit_desc_cale"]').addClass("is-invalid"),$("#error_edit_desc_cale").addClass("invalid-feedback").empty().html(e.responseJSON.errors.desc_cale[0])),void 0!==e.responseJSON.errors.fina_cale&&($('textarea[name="edit_fina_cale"]').addClass("is-invalid"),$("#error_edit_fina_cale").addClass("invalid-feedback").empty().html(e.responseJSON.errors.fina_cale[0]))):swal({title:e.responseJSON.message,type:"error",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})},complete:function(){$(".loading").hide(),$("#updateCalendario").find('button[type="submit"]').attr("disabled",!1)}})}),$(".delete").click(function(e){e.preventDefault();var a=$("[name='id']").val().trim();swal({title:"¿Está seguro de eliminar?",text:"¡No podrás revertir esto!",type:"warning",showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Eliminar",buttonsStyling:!1,confirmButtonClass:"btn btn-danger",cancelButtonClass:"btn"}).then(function(e){e.value&&($(".loading").show(),$.ajax({url:"/calendarios/"+a,type:"DELETE",dataType:"JSON",headers:{"X-CSRF-TOKEN":$("[name='_token']").val()},cache:!1}).done(function(e){$(".loading").hide(),$("#editCalendario").modal("hide"),$("#calendar").fullCalendar("refetchEvents"),swal({title:e.message,type:"success",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})}).fail(function(e){$(".loading").hide(),swal({title:e.responseJSON.message,type:"error",toast:!0,showConfirmButton:!1,timer:3e3,position:"top-right"})}))})})});
